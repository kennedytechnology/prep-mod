<span class="text-xl font-bold">
  <%= t 'views.public.patients.edit.add_family.header' %>
</span>

<div data-controller="consent-form-signature">
  <%= f.fields_for :patient_family_members do |fm| %>
    <div class="member-<%= fm.object.object_id %>">
       <div class="flex justify-between mt-20">
        <h2 class="text-xl font-bold"> <%= t 'views.public.patients.edit.add_family.family_member_section' %> </h2>
        <%= fm.hidden_field :_destroy %>
        <%= link_to t('views.public.patients.edit.add_family.delete_member'), 'javascript:',
            class: 'button-danger',
            style: "width: auto; height: 25px; font-size: 0.75rem",
            data: {
              member: "#{fm.object.object_id}",
              action: "click->consent-form-signature#onRemoveFamilyMember"
            } %>
        </div>

      <div class="family-member-form mt-6 border-b">
        <div class="w-full md:flex">
          <div class="inline-field-wrapper">
              <%= fm.label :first_name do %>
                <span> <%= t 'activerecord.models.patient.first_name' %> </span>
                <span class="field-required">*</span>
              <% end %>
              <%= fm.text_field :first_name, class: "w-full form-input", required: true %>
          </div>
          <div class="inline-field-wrapper inline-field-wrapper-narrow">
              <%= fm.label :middle_initial, t('activerecord.models.patient.middle_initial') %>
              <%= fm.text_field :middle_initial, class: "w-full form-input" %>
          </div>
          <div class="inline-field-wrapper">
              <%= fm.label :last_name do %>
                <span> <%= t 'activerecord.models.patient.last_name' %> </span>
                <span class="field-required">*</span>
              <% end %>
              <%= fm.text_field :last_name, class: "w-full form-input", required: true %>
          </div>
          <div class="inline-field-wrapper">
              <%= fm.label :mothers_maiden_name do %>
                <span> <%= t 'activerecord.models.patient.mothers_maiden_name' %> </span>
                <span class="field-required">*</span>
              <% end %>
              <%= fm.text_field :mothers_maiden_name, class: "w-full form-input", required: true %>
          </div>
          <div class="inline-field-wrapper">
            <%= fm.label :race do %>
                <span> <%= t 'activerecord.models.patient.race' %> </span>
                <span class="field-required">*</span>
            <% end %>
            <%= fm.select :race, options_for_select(US_RACES, @patient.race), {prompt: "--"}, {class: "form-select w-full", required: true} %>
          </div>
          <div class="inline-field-wrapper">
            <%= fm.label :date_of_birth do %>
                <span> <%= t 'activerecord.models.patient.date_of_birth' %> </span>
                <span class="field-required">*</span>
            <% end %>
            <%= fm.text_field :date_of_birth, class: "w-full form-input", required: true,
                                  data: { controller: "flatpickr", flatpickr_max_date: "today" } %>
          </div>
        </div>

        <div class="md:flex" data-controller="same-as-parent">
          <div class="inline-field-wrapper pt-7">
          <label>
            <input type="checkbox" data-action="change->same-as-parent#applyValues">
            <%= t 'views.public.patients.edit.add_family.same_insurance' %></label>
          </div>

          <div class="inline-field-wrapper">
            <%= fm.label :insurance_company_name, t('activerecord.models.patient.insurance_company_name') %>
            <%= fm.text_field :insurance_company_name, class: "w-full form-input", data: {parent_field: @patient.insurance_company_name, target: "same-as-parent.field" } %>
          </div>

          <div class="inline-field-wrapper">
            <%= fm.label :member_id_for_insurance, t('activerecord.models.patient.member_id_for_insurance') %>
            <%= fm.text_field :member_id_for_insurance, class: "w-full form-input", data: {parent_field: @patient.member_id_for_insurance, target: "same-as-parent.field" } %>
          </div>

          <div class="inline-field-wrapper">
            <%= fm.label :group_number_for_insurance, t('activerecord.models.patient.group_number_for_insurance') %>
            <%= fm.text_field :group_number_for_insurance, class: "w-full form-input", data: {parent_field: @patient.group_number_for_insurance, target: "same-as-parent.field" } %>
          </div>
        </div>
      </div>
      <p class="field-required mb-3"> <%= t 'views.public.patients.edit.add_family.complete_field' %> </p>
    <p class="font-bold mb-4"> <%= t 'views.public.patients.edit.add_family.health_questions_title' %> </p>
    <div class="field-side-by-side">
        <div>
            <h2 class="title"> <%= t 'views.public.patients.edit.add_family.do_you_have' %> </h2>
            <%= fm.check_box :has_fever_over, class: "form-checkbox" %>
            <%= fm.label :has_fever_over, t('activerecord.models.patient.has_fever_over') %>

            <br />
            <%= fm.check_box :has_cough, class: "form-checkbox" %>
            <%= fm.label :has_cough, t('activerecord.models.patient.has_cough') %>

            <br />
            <%= fm.check_box :has_difficult_breathing, class: "form-checkbox" %>
            <%= fm.label :has_difficult_breathing, t('activerecord.models.patient.has_difficult_breathing') %>
        </div>
        <div>
            <h2 class="title"> <%= t 'views.public.patients.edit.add_family.have_you_traveled' %> <span class="field-required">*</span> </h2>
            <% t('activerecord.models.patient.had_traveled_to_affected_place').each do |h| %>
              <label class="mr-3"><%= f.radio_button :had_traveled_to_affected_place, h == 'Yes' ? true : false %>
                <span><%= h %></span>
              </label>
            <% end %>
        </div>
    </div>

    <div class="field-side-by-side">
        <div>
            <h2 class="title"> <%= t 'views.public.patients.edit.add_family.close_contact' %> <span class="field-required">*</span> </h2>
            <% t('activerecord.models.patient.had_contact_with_confirmed_case').each do |c| %>
              <label class="mr-3"><%= f.radio_button :had_contact_with_confirmed_case, c == 'Yes' ? true : false %>
                <span><%= c %></span>
              </label>
            <% end %>
        </div>
        <div>
            <h2 class="title"> <%= t 'views.public.patients.edit.add_family.diseases' %> <span class="field-required">*</span></h2>
            <% t('activerecord.models.patient.has_risk_factor').each do |r| %>
              <label class="mr-3"><%= f.radio_button :has_risk_factor, r == 'Yes' ? true : false %>
                <span><%= r %></span>
              </label>
            <% end %>
        </div>
    </div>

      <div class="field-side-by-side">
          <div>
              <h2 class="title"> <%= t 'views.public.patients.edit.add_family.age_question' %> <span class="field-required">*</span></h2>
              <% t('activerecord.models.patient.is_age_60_or_more').each do |s| %>
                <label class="mr-3"><%= f.radio_button :is_age_60_or_more, s == 'Yes' ? true : false %>
                  <span><%= s %></span>
                </label>
              <% end %>
          </div>
          <div>
              <h2 class="title"> <%= t 'views.public.patients.edit.add_family.testing_reasons' %> <span class="field-required">*</span></h2>
              <% t('activerecord.models.patient.has_other_reason').each do |o| %>
                <label class="mr-3"><%= f.radio_button :has_other_reason, o == 'Yes' ? true : false %>
                  <span><%= o %></span>
                </label>
              <% end %>
          </div>
      </div>
    </div>
  <% end %>
</div>