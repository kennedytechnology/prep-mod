<%= content_for :prevent_unsaved_form_script do %>
    <%= javascript_pack_tag 'prevent_unsaved_form', 'data-turbolinks-track': 'reload' %>
<% end %>
<% if current_user.can_create_user? %>
  <h1 class="main-title"><%= t "devise.invitations.new.header" %></h1>

  <%= form_for(resource, as: resource_name, url: invitation_path(resource_name), html: { method: :post, class: "mb-8" }) do |f| %>
      <%= render "devise/shared/error_messages", resource: resource %>

      <%# resource.class.invite_key_fields.each do |field| -%>
          <div class="field-side-by-side">
              <div>
                  <%= f.label :first_name, class: "block" do %>
                      <span> First Name </span>
                      <span class="field-required">*</span>
                  <% end %>
                  <%= f.text_field :first_name, class: "form-input w-full", required: true %>

                  <%= f.label :last_name, class: "block" do %>
                      <span> Last Name </span>
                      <span class="field-required">*</span>
                  <% end %>
                  <%= f.text_field :last_name, class: "form-input w-full", required: true %>

                <div data-controller="email-confirmation">
                  <%= f.label :email, class: "block" do %>
                      <span> Email </span>
                      <span class="field-required">*</span>
                  <% end %>
                  <%= f.email_field :email, class: "form-input w-full", required: true,
                        data: { target: "email-confirmation.emailField",
                                action: "keyup->email-confirmation#emailConfirmation
                                        change->email-confirmation#emailConfirmation"} %>

                  <%= f.label :email_confirmation, class: "block" do %>
                      <span> Email Confirmation</span>
                      <span class="field-required">*</span>
                  <% end %>
                  <%= f.email_field :email_confirmation, class: "form-input w-full", required: true,
                        data: { target: "email-confirmation.confirmEmailField",
                                action: "keyup->email-confirmation#emailConfirmation
                                        change->email-confirmation#emailConfirmation"} %>
                  <p class="text-red-600 -mt-2 text-xs mb-4" data-target="email-confirmation.confirmEmailError"> </p>
                </div>

                  <%= f.label :county, class: "block" do %>
                      <span> County </span>
                  <% end %>
                  <%= f.select :county, COUNTIES, {prompt: "Select"}, {class: "form-select w-full"} %>

                <div class="" data-controller="consent-form">
                  <p class="label">
                    <span> Choose Venues: </span>
                  </p>
                  <p data-target="consent-form.companyInputField" class="text-lg md:text-xl lg:text-xl"></p>
                  <div class="multiselect-dropdown">
                    <div class="selectBox" data-action="click->consent-form#showCheckboxes">
                      <input type="text" id="predict_company_name" data-action="keyup->consent-form#search" placeholder="Search venue name" class="form-input w-full md:w-1/3 lg:w-full" style="height: 50px;" />
                    </div>
                    <div class="checkboxes-in-dropdown w-full" id="locationsCheckboxes" data-target="consent-form.locationsCheckboxes">
                      <%= collection_check_boxes(:user, :venue_ids, Venue.all, :id, :name) do |b| %>
                        <div class="relative flex items-start px-3 hover:bg-blue-50" data-target="consent-form.searchableRow" data-search-content="<%= [b.object.name.try(:downcase)] %>">
                          <div class="absolute flex items-center h-5">
                            <%= b.check_box(class: "form-checkbox cursor-pointer text-base font-bold",
                                            data: {action: "click->consent-form#displayLocations",
                                                   locations: "",
                                                   employer: "#{b.object.name}",
                                                   target: "consent-form.companyCheckbox"
                                            }) %>
                          </div>
                          <div class="pl-6 text-sm leading-5">
                            <%= b.label %>
                          </div>
                        </div>
                      <% end %>
                    </div>
                  </div>
                </div>


                  <%= f.label :role, class: "block" do %>
                      <span> Role </span>
                      <span class="field-required">*</span>
                  <% end %>
                  <%= f.select :role, current_user.assignable_roles.reject{|role| role == ["Super Admin", "super_admin"]}, {prompt: "Select"}, {class: "form-select w-full", required: true} %>
              </div>
              <div></div>
          </div>
      <%# end -%>

      <div class="actions">
          <%= f.submit t("devise.invitations.new.submit_button"), class: "button-primary", id: "submitButton" %>
      </div>
  <% end %>
<% else %>
  <% raise CanCan::AccessDenied %>
<% end %>
