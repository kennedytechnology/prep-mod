<div class="header">
  <h1 class="main-title lg:mb-0">Patient History</h1>
  <h2 class="text-2xl font-bold text-gray-400 mb-8"><%= @patient.full_name %></h2>
</div>

<div class="flex justify-between items-center mb-3">
  <% if @clinic %>
    <div>
        <%= link_to "Back to records", clinic_patients_path(@clinic), class: "button-action" %>
        <% if @patient.consent_date %>
            <%= link_to "View Consent", clinic_patient_path(@clinic, @patient, format: :pdf), class: "button-action" %>
        <% end %>
    </div>
  <% else %>
    <%= link_to "Back to records", patients_records_search_path, class: "button-action" %>
  <% end %>
    <a href="javascript:" class="button-primary" onclick="window.print();">Print</a>
</div>

<div data-controller="clinic-activity-patients">
<table class="table printable">
    <thead>
        <tr>
            <th>Date</th>
            <th>Location</th>

            <th>Service</th>
            <th>Status</th>
            <th>Notes</th>
            <th class="table-action-buttons">Actions</th>
        </tr>
    </thead>
    <tbody>
        <% @patient_clinic_events.each do |clinic_event| %>
        <tr>
            <td><%= clinic_event.clinic ? clinic_event.clinic.clinic_date.try(:strftime, "%m/%d/%Y") : clinic_event.event_date.try(:strftime, "%m/%d/%Y") %></td>
            <td><%= clinic_event.clinic ? clinic_event.clinic.venue_name : clinic_event.location %></td>

            <td><%= clinic_event.category %></td>
            <td><%= clinic_event.outcome %></td>
            <td><%= clinic_event.notes %></td>
            <td class="table-action-buttons">
                <%= link_to "Delete", "javascript:",
                    data: {recordis: "clinic_events", recordid: clinic_event.id,
                        action: "click->clinic-activity-patients#showHideDeleteModal"}, class: "button-action" %>
            </td>
        </tr>
        <% end %>
    </tbody>
</table>
<%= render "patients/delete_record_modal" %>
</div>